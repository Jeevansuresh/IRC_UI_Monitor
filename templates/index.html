<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technocrats Robotics - ROS2 Rover Monitor</title>

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body class="scrollbar-thin">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <div class="sidebar w-64 scrollbar-thin hidden lg:block">
            <div class="sidebar-section">
                <h1 class="text-xl font-bold text-white">VITC Technocrats Robotics</h1>
                <p class="text-xs text-gray-400">IRC Rover Monitor</p>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">Status</div>
                <div class="flex items-center mb-3">
                    <span class="pulse-dot online"></span>
                    <span class="text-sm" id="connection-status">Connecting...</span>
                </div>
                <div class="text-xs text-gray-400">
                    <p>System: <span id="system-status" class="text-red-400">Offline</span></p>
                    <p>Nodes Active: <span id="active-nodes" class="text-cyan-400">0</span></p>
                </div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">Navigation</div>
                <div class="sidebar-item active" onclick="switchTab(event, 'overview')">üìä Overview</div>
                <div class="sidebar-item" onclick="switchTab(event, 'cameras')">üì∑ Cameras</div>
                <div class="sidebar-item" onclick="switchTab(event, 'sensors')">üîß Sensors</div>
                <div class="sidebar-item" onclick="switchTab(event, 'control')">üéÆ Control</div>
                <div class="sidebar-item" onclick="switchTab(event, 'logs')">üìã Logs</div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">Topics</div>
                <div id="topics-list" class="space-y-1 max-h-96 overflow-y-auto">
                    <!-- Dynamically populated -->
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 overflow-auto">
            <nav class="glass-effect sticky top-0 z-50 px-6 py-4 border-b border-gray-700">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold">ROS2 Rover Monitor</h2>
                    <div class="flex items-center gap-4">
                        <div id="timestamp" class="text-xs text-gray-400"></div>
                        <button class="btn-secondary" onclick="toggleSettings()">‚öôÔ∏è Settings</button>
                    </div>
                </div>
            </nav>

            <div class="p-6">
                <!-- Overview Tab -->
                <div id="overview-tab" class="tab-content">
                    <!-- System Health -->
                    <div class="mb-6">
                        <h3 class="text-lg font-bold mb-4">System Health</h3>
                        <div class="grid-cols-responsive">
                            <div class="card">
                                <div class="metric-label">CPU Usage</div>
                                <div class="metric-value" id="cpu-usage">0%</div>
                                <div class="mt-3 bg-gray-700 rounded-full h-2">
                                    <div class="bg-cyan-500 h-2 rounded-full transition-all" id="cpu-bar" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="metric-label">Memory Usage</div>
                                <div class="metric-value" id="memory-usage">0%</div>
                                <div class="mt-3 bg-gray-700 rounded-full h-2">
                                    <div class="bg-green-500 h-2 rounded-full transition-all" id="memory-bar" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="metric-label">Active Nodes</div>
                                <div class="metric-value" id="nodes-count">0</div>
                                <div class="status-badge online mt-3" id="nodes-status">
                                    <span class="pulse-dot online"></span> Monitoring
                                </div>
                            </div>
                            <div class="card">
                                <div class="metric-label">Network Latency</div>
                                <div class="metric-value" id="latency">0ms</div>
                                <div class="text-xs text-gray-400 mt-3">WebSocket</div>
                            </div>
                        </div>
                    </div>

                    <!-- Odometry & Navigation -->
                    <div class="mb-6">
                        <h3 class="text-lg font-bold mb-4">Navigation Data</h3>
                        <div class="grid-cols-responsive">
                            <div class="card">
                                <div class="metric-label">Position X</div>
                                <div class="metric-value" id="pos-x">0.00</div>
                                <div class="text-xs text-gray-400 mt-2">meters</div>
                            </div>
                            <div class="card">
                                <div class="metric-label">Position Y</div>
                                <div class="metric-value" id="pos-y">0.00</div>
                                <div class="text-xs text-gray-400 mt-2">meters</div>
                            </div>
                            <div class="card">
                                <div class="metric-label">Heading</div>
                                <div class="metric-value" id="heading">0¬∞</div>
                                <div class="text-xs text-gray-400 mt-2">degrees</div>
                            </div>
                            <div class="card">
                                <div class="metric-label">Velocity</div>
                                <div class="metric-value" id="velocity">0.00</div>
                                <div class="text-xs text-gray-400 mt-2">m/s</div>
                            </div>
                        </div>
                    </div>

                    <!-- GPS & Sensors -->
                    <div class="mb-6">
                        <h3 class="text-lg font-bold mb-4">Sensor Data</h3>
                        <div class="grid-cols-responsive">
                            <div class="card">
                                <div class="metric-label">GPS Latitude</div>
                                <div class="metric-value text-lg" id="gps-lat">0.0000</div>
                                <div class="text-xs text-gray-400 mt-2">degrees</div>
                            </div>
                            <div class="card">
                                <div class="metric-label">GPS Longitude</div>
                                <div class="metric-value text-lg" id="gps-lon">0.0000</div>
                                <div class="text-xs text-gray-400 mt-2">degrees</div>
                            </div>
                            <div class="card">
                                <div class="metric-label">Temperature</div>
                                <div class="metric-value" id="temp">0¬∞C</div>
                                <div class="text-xs text-gray-400 mt-2">sensor</div>
                            </div>
                            <div class="card">
                                <div class="metric-label">Battery Voltage</div>
                                <div class="metric-value" id="battery">0V</div>
                                <div class="text-xs text-gray-400 mt-2">pack</div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <div class="card">
                            <h4 class="font-semibold mb-4">Velocity History</h4>
                            <div class="chart-container">
                                <canvas id="velocity-chart"></canvas>
                            </div>
                        </div>
                        <div class="card">
                            <h4 class="font-semibold mb-4">System Resources</h4>
                            <div class="chart-container">
                                <canvas id="resources-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cameras Tab -->
                <div id="cameras-tab" class="tab-content hidden">
                    <h3 class="text-lg font-bold mb-4">Camera Feeds</h3>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="card">
                            <div class="text-sm font-semibold mb-2">Front Camera</div>
                            <div class="camera-feed" id="cam-front">
                                <span>Camera 1 Stream</span>
                            </div>
                            <div class="text-xs text-gray-400 mt-2">
                                <span class="inline-block px-2 py-1 bg-gray-700 rounded mt-2">FPS: <span id="cam1-fps">0</span></span>
                            </div>
                        </div>
                        <div class="card">
                            <div class="text-sm font-semibold mb-2">Rear Camera</div>
                            <div class="camera-feed" id="cam-rear">
                                <span>Camera 2 Stream</span>
                            </div>
                            <div class="text-xs text-gray-400 mt-2">
                                <span class="inline-block px-2 py-1 bg-gray-700 rounded mt-2">FPS: <span id="cam2-fps">0</span></span>
                            </div>
                        </div>
                        <div class="card">
                            <div class="text-sm font-semibold mb-2">Left Camera</div>
                            <div class="camera-feed" id="cam-left">
                                <span>Camera 3 Stream</span>
                            </div>
                            <div class="text-xs text-gray-400 mt-2">
                                <span class="inline-block px-2 py-1 bg-gray-700 rounded mt-2">FPS: <span id="cam3-fps">0</span></span>
                            </div>
                        </div>
                        <div class="card">
                            <div class="text-sm font-semibold mb-2">Right Camera</div>
                            <div class="camera-feed" id="cam-right">
                                <span>Camera 4 Stream</span>
                            </div>
                            <div class="text-xs text-gray-400 mt-2">
                                <span class="inline-block px-2 py-1 bg-gray-700 rounded mt-2">FPS: <span id="cam4-fps">0</span></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sensors Tab -->
                <div id="sensors-tab" class="tab-content hidden">
                    <h3 class="text-lg font-bold mb-4">Sensor Readings</h3>
                    <div class="space-y-3" id="sensors-list">
                        <!-- Dynamically populated -->
                    </div>
                </div>

                <!-- Control Tab -->
                <div id="control-tab" class="tab-content hidden">
                    <h3 class="text-lg font-bold mb-4">Rover Control</h3>
                    <div class="card max-w-md">
                        <div class="mb-6">
                            <label class="metric-label">Input Velocity (m/s)</label>
                            <input type="range" min="-2" max="2" step="0.1" value="0" id="velocity-input" class="w-full mt-3" />
                            <div class="text-center mt-2">
                                <span class="metric-value" id="velocity-display">0.0</span>
                                <span class="text-gray-400 ml-2">m/s</span>
                            </div>
                        </div>

                        <div class="mb-6">
                            <label class="metric-label">Angular Velocity (rad/s)</label>
                            <input type="range" min="-1" max="1" step="0.1" value="0" id="angular-input" class="w-full mt-3" />
                            <div class="text-center mt-2">
                                <span class="metric-value" id="angular-display">0.0</span>
                                <span class="text-gray-400 ml-2">rad/s</span>
                            </div>
                        </div>

                        <div class="flex gap-3">
                            <button class="btn-primary flex-1" onclick="sendCommand('start')">‚ñ∂Ô∏è Start</button>
                            <button class="btn-secondary flex-1" onclick="sendCommand('stop')">‚èπÔ∏è Stop</button>
                        </div>
                    </div>

                    <div class="card max-w-md mt-6">
                        <div class="metric-label mb-4">Action Buttons</div>
                        <div class="grid grid-cols-2 gap-3">
                            <button class="btn-primary text-sm" onclick="sendCommand('arm')">üîí Arm</button>
                            <button class="btn-primary text-sm" onclick="sendCommand('disarm')">üîì Disarm</button>
                            <button class="btn-secondary text-sm" onclick="sendCommand('home')">üè† Home</button>
                            <button class="btn-secondary text-sm" onclick="sendCommand('reset')">‚Üª Reset</button>
                        </div>
                    </div>
                </div>

                <!-- Logs Tab -->
                <div id="logs-tab" class="tab-content hidden">
                    <h3 class="text-lg font-bold mb-4">System Logs</h3>
                    <div class="card max-h-96 overflow-y-auto scrollbar-thin">
                        <div id="logs-container" class="space-y-2 font-mono text-xs">
                            <!-- Logs populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Socket.IO for real-time communication -->
    <script src="https://cdn.socket.io/4.7.0/socket.io.min.js"></script>

    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
